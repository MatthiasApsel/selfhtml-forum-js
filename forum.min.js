(function(){Object.forEach||(Object.forEach=function(t,n){for(var r in t)t.hasOwnProperty(r)&&n.call(t,r,t[r])}),function(){var e=function(t){if(typeof t!="function")throw new TypeError;var n=this.length;for(var r=0;r<n;r++)t.call(this,this[r],r)};Array.prototype.forEach||(Array.prototype.forEach=e),NodeList.prototype.forEach||(NodeList.prototype.forEach=e);if(document.querySelectorAll){var t=document.querySelectorAll(":root");t.forEach||(t.constructor.prototype.forEach=e)}}(),Array.convert=function(t){return Array.prototype.slice.apply(t)},Function.prototype.curry=function(){if(arguments.length===0)return this;var t=this,n=Array.convert(arguments);return function(){return t.apply(this,n.concat(Array.convert(arguments)))}},String.prototype.escapeHTML=function(){return this.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&lt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")},Element.prototype.getElementByXPath=function(t){try{return document.evaluate(t,this,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue}catch(n){console.log(t,n)}},Element.prototype.getElementsByXPath=function(t){try{return document.evaluate(t,this,null,XPathResult.ORDERED_NODE_ITERATOR_TYPE,null)}catch(n){console.log(t,n)}},function(){var e={},t=Element.prototype;t.toggleClass=function(t){this.hasClass(t)?this.removeClass(t):this.addClass(t)},t.addClass=function(t){this.hasClass(t)||(this.className+=(this.className?" ":"")+t)},t.removeClass=function(t){this.className=this.className.replace(new RegExp("(^|\\s)"+t+"(\\s|$)"),"$2")},t.hasClass=function(t){return(" "+this.className+" ").indexOf(" "+t+" ")>-1},delete t}(),XPathResult.prototype.forEach=function(t){var n,r=0,i=this.resultType==XPathResult.ORDERED_NODE_ITERATOR_TYPE?"iterateNext":"snapshotItem";while(n=this[i](r++))t(n)},XPathResult.prototype.toArray=function(){var t=[],n,r=0,i=this.resultType==XPathResult.ORDERED_NODE_ITERATOR_TYPE?"iterateNext":"snapshotItem";while(n=this[i](r++))t.push(n);return t};var e={};e.Forum={},e.Forum.Support={querySelectorAll:!!document.querySelector&&!!document.querySelectorAll,getElementsByClassName:!!document.getElementsByClassName},e.Forum.getThreadStart=function(t){return t.getElementByXPath("ancestor::li[contains(@class, 'thread-start')]")},e.Forum.Modules={},e.Forum.Modules.queue=[],e.Forum.Modules.add=function(n,r){e.Forum.Modules.queue.push({documentType:n,module:r})},e.Forum.Modules.init=function(){e.Forum.Modules.queue.forEach(function(t){(document.body.id=="selfforum-"+t.documentType||t.documentType=="all")&&t.module.init()})},document.addEventListener("DOMContentLoaded",e.Forum.Modules.init,!1),e.Forum.init=function(){e.Forum.ready=!0},e.Forum.Modules.add("all",e.Forum),e.Forum.Hauptseite={},e.Forum.Hauptseite.init=function(){e.Forum.threadList=document.getElementById("root")},e.Forum.Modules.add("hauptseite",e.Forum.Hauptseite),e.Forum.ThreadListCache={},e.Forum.ThreadListCache.init=function(){var n=e.Forum,r=n.Support,i=n.threadList,s=n.postingsByAuthor={},o=n.threadStartsByAuthor={},u=n.ownPostings=[],a=n.postingsByCategory={};r.getElementsByClassName?authorSpans=i.getElementsByClassName("author"):r.querySelectorAll?authorSpans=i.querySelectorAll(".author"):authorSpans=i.getElementsByXPath("descendant::span[@class = 'author']").toArray();for(var f=0,l=authorSpans.length;f<l;f++){var c=authorSpans[f],h=c.firstChild.nodeValue,p=c.parentNode,d=p.parentNode,v=d.id,m=d.parentNode.parentNode,g;d.hasClass("own-posting")&&(u.push(d),n.ownName||(n.ownName=h)),(s[h]||(s[h]=[])).push(d),m.hasClass("thread-start")&&(o[h]||(o[h]=[])).push(m),g=p.firstChild.firstChild.childNodes[1].nodeValue,(a[g]||(a[g]=[])).push(d)}},e.Forum.Modules.add("hauptseite",e.Forum.ThreadListCache),e.Forum.ContextMenu={},e.Forum.ContextMenu.init=function(){var n=e.Forum,r=n.ContextMenu;r.target=document.getElementById("contextMenuTitle"),n.threadList.addEventListener("click",r.toggle,!1),n.threadList.addEventListener("mouseover",r.threadListMouseOver,!0)},e.Forum.Modules.add("hauptseite",e.Forum.ContextMenu),e.Forum.ContextMenu.visible=!1,e.Forum.ContextMenu.getLinks=function(n,r){var i=e.Forum,s=i.ContextMenu,o=i.Config,u=i.Filter,a=i.Statistics,f={};if(r=="author"){var l=n.firstChild.nodeValue,c=n.hasClass("own-posting"),h=n.hasClass("whitelist");f["Filtere nach Autor"]=u.filterByAuthor.curry(l),h?f["Autor von der Whitelist l\u00f6schen"]=o.removeFromWhiteList.curry(l):c||(f["Autor zur Whitelist hinzuf\u00fcgen"]=o.addToWhiteList.curry(l)),c||(f["Autor zur Blacklist hinzuf\u00fcgen"]=o.addToBlackList.curry(l)),f["Zeige Autoren-Statistik"]=a.show.curry("author")}else if(r=="category"){var p=n.childNodes[1].nodeValue,d=n.hasClass("category");f["Filtere nach Themenbereich"]=u.filterByCategory.curry(p),d?f["Themenbereich hervorheben"]=o.addToHighlightCategories.curry(p):f["Themenbereich nicht mehr hervorheben"]=o.removeFromHighlightCategories.curry(p),f["Zeige Themenbereich-Statistik"]=a.show.curry("category")}return f["Men\u00fc ausblenden"]=s.hide,f},e.Forum.ContextMenu.toggle=function(n){var r=e.Forum.ContextMenu,i=n.target,s=i.hasClass("author"),o=i.hasClass("category"),u=i.hasClass("cathigh"),a=s?"author":o||u?"category":!1;if(a)if(r.visible)r.hide();else{var f=r.getLinks(i,a);r.show(i,f)}else r.hide()},e.Forum.ContextMenu.show=function(n,r){var i=e.Forum,s=i.ContextMenu;s.target&&s.target.removeAttribute("id"),n.id="contextMenuTitle";var o=(new i.Layer({id:"contextMenu",tagName:"ul"})).html(""),u=o.element;Object.forEach(r,function(e,t){var n=function(e){e.preventDefault(),t.call(this,e)},r=document.createElement("li");u.appendChild(r);var i=document.createElement("a");r.appendChild(i),i.href="javascript:void(0)",i.addEventListener("click",n,!1),i.appendChild(document.createTextNode(e))}),u.style.top=n.offsetTop+n.offsetHeight-1+"px",u.style.left=n.offsetLeft+"px",o.show(),s.target=n},e.Forum.ContextMenu.hide=function(){var n=e.Forum,r=n.ContextMenu;r.target&&r.target.removeAttribute("id"),(new n.Layer({id:"contextMenu"})).hide()},e.Forum.ContextMenu.threadListMouseOver=function(t){var n=t.target;!n.hasClass("javascript-button")&&(n.hasClass("author")||n.hasClass("category")||n.hasClass("cathigh"))&&n.addClass("javascript-button")},e.Forum.Layer=function(t){if(!t||!t.id)throw new TypeError;var n=arguments.callee.layers||(arguments.callee.layers={});if(n[t.id])return n[t.id];if(!t.tagName)return;t.parent||(t.parent=document.body);var r=document.createElement(t.tagName);r.id=t.id,t.className&&(r.className=t.className),t.parent.appendChild(r),this.element=r,n[t.id]=this},e.Forum.Layer.prototype={show:function(){return this.element&&(this.element.style.display="block"),this},hide:function(){return this.element&&(this.element.style.display="none"),this},html:function(t){return this.element&&(this.element.innerHTML=t),this}},e.Forum.Info={},e.Forum.Info.show=function(n){(new e.Forum.Layer({id:"scriptInfo",tagName:"div",parent:document.getElementById("kopf-haupt")})).html(n).show()},e.Forum.Info.hide=function(n){(new e.Forum.Layer({id:"scriptInfo"})).hide()},e.Forum.Filter={},e.Forum.Filter.init=function(){var n=e.Forum.Filter;n.active=!1,n.highlightedPostings=[],n.filteredThreads=[],n.initCategoryFilter()},e.Forum.Modules.add("hauptseite",e.Forum.Filter),e.Forum.Filter.initCategoryFilter=function(){var n=e.Forum,r=n.Filter,i=document.getElementById("themenfilter").getElementsByTagName("form")[0];i.addEventListener("submit",function(e){e.preventDefault();var t=this.elements.lf,n=t.options[t.selectedIndex],i=n.text;n.value?r.filterByCategory(i):r.remove()},!1)},e.Forum.Filter.filterByAuthor=function(n){var r=e.Forum,i=r.Filter;i.remove(),r.ContextMenu.hide();var s=r.postingsByAuthor[n];s&&s.forEach(function(t){t.addClass("highlighted"),i.highlightedPostings.push(t);var n=r.getThreadStart(t);n.addClass("contains-filter-postings"),i.filteredThreads.push(n)}),r.threadList.addClass("filter"),r.Info.show("Gefiltert nach Autor "+n+" &ndash; <a href='javascript:SELFHTML.Forum.Filter.remove()'>Filter entfernen</a>"),i.active=!0},e.Forum.Filter.filterByCategory=function(n){var r=e.Forum,i=r.Filter;i.remove(),r.ContextMenu.hide();var s=r.postingsByCategory[n];s&&s.forEach(function(t){var n=r.getThreadStart(t);n.addClass("contains-filter-postings"),i.filteredThreads.push(n)}),r.threadList.addClass("filter"),r.Info.show("Gefiltert nach Themenbereich "+n+" &ndash; <a href='javascript:SELFHTML.Forum.Filter.remove()'>Filter entfernen</a>"),i.active=!0},e.Forum.Filter.remove=function(){var n=e.Forum,r=n.Filter;if(!r.active)return;n.Info.hide();var i,s;while(i=r.filteredThreads.shift())i.removeClass("contains-filter-postings");while(s=r.highlightedPostings.shift())s.removeClass("highlighted");n.threadList.removeClass("filter"),r.active=!1},e.Forum.FollowupNotice={},e.Forum.FollowupNotice.init=function(){var n=e.Forum,r=n.Support,i=n.threadList,s;r.querySelectorAll?s=i.querySelectorAll("li.own-posting > ul > li:not(.visited) > .posting"):s=i.getElementsByXPath("descendant::li[contains(@class, 'own-posting')]/ul/li[not(contains(@class, 'visited'))]").toArray();var o="kopf-menue",u=document.getElementById(o);if(!u)return;var a=[];s.forEach(function(t){var n,i,s;r.querySelectorAll?(s=t,n=t.querySelector("span.subject a"),i=t.querySelector("span.author")):(s=t.getElementByXPath("(span | span/span)[contains(@class, 'posting')]"),n=s.getElementByXPath("span[contains(@class, 'subject')]/a"),i=s.getElementByXPath("span[contains(@class, 'author')]"));if(window.getComputedStyle(n,null).outlineStyle=="solid")return;a.push({title:n.firstChild.nodeValue,href:n.href,author:i.firstChild.nodeValue})});var f=new n.Layer({id:"followup-notice",tagName:"div",parent:u}),l="";a.length>0?(f.element.className="new-anwers",l+="<h2>Neue Antworten</h2>",l+="<ul>",a.forEach(function(t){l+="<li><a href='"+t.href+"'>"+t.title.escapeHTML()+"</a>",l+=" von "+t.author.escapeHTML()+"</li>"}),l+="</ul>"):(f.element.className="no-anwers",l+="<h2>Keine neuen Antworten</h2>"),f.html(l)},e.Forum.Modules.add("hauptseite",e.Forum.FollowupNotice),e.Forum.Config={},e.Forum.Config.directives={BlackList:{parameter:"blacklist",type:"list"},WhiteList:{parameter:"whitelst",type:"list"},HighlightCategories:{parameter:"highlightcats",type:"list"},SortThreads:{parameter:"sortthreads",type:"single"}},e.Forum.Config.init=function(){var n=e.Forum,r=n.Config;Object.forEach(r.directives,function(e,t){if(t.type!="list")return;r["addTo"+e]=function(t){r.setValue(e,t),r.confirmReload()},r["removeFrom"+e]=function(t){r.removeValue(e,t),r.confirmReload()}})},e.Forum.Modules.add("hauptseite",e.Forum.Config),e.Forum.Config.setValue=function(n,r){var i=e.Forum,s=i.Config,o=s.directives[n];if(!o)return;var u=userconf_uri+"?a=setvalue&directive="+n+"&"+o.parameter+"="+encodeURIComponent(r)+(o.type=="list"?"&type=stringlist":"")+"&unique="+(new Date).getTime();xmlhttp_get_contents(xmlhttp,u,null,null)},e.Forum.Config.removeValue=function(n,r){var i=e.Forum,s=i.Config,o=s.directives[n];if(!o)return;var u=userconf_uri+"?a=removevalue&directive="+n+"&"+o.parameter+"="+encodeURIComponent(r)+(o.type=="list"?"&type=stringlist":"")+"&unique="+(new Date).getTime();xmlhttp_get_contents(xmlhttp,u,null,null)},e.Forum.Config.confirmReload=function(){var t="Die Einstellung wurde auf dem Server gespeichert. Soll die Forumshauptseite jetzt neu geladen werden?";window.confirm(t)&&location.reload()},e.Forum.Statistics={},e.Forum.Statistics.init=function(n){if(typeof n!="string"){arguments.callee("author"),arguments.callee("category");return}var r=e.Forum,i=r.Filter,s=r.Statistics,o=n=="author"?r.postingsByAuthor:r.postingsByCategory,u,a=[];Object.forEach(o,function(t,n){a.push({typeName:t,postingNumber:n.length})}),a.sort(function(t,n){return t.postingNumber>n.postingNumber?-1:1}),n=="author"?r.authorRanking=a:r.categoryRanking=a;var f="<p><a href='javascript:void(0)' class='hide'>Ausblenden</a></p>";f+="<table><tbody>",a.forEach(function(t){f+="<tr><th><a href='javascript:void(0)'>"+t.typeName.escapeHTML()+"</th><td>"+t.postingNumber+"</td></tr>"}),f+="</tbody></table>";var l=new r.Layer({id:n+"Statistics",tagName:"div",className:"statistics"});l.html(f),l.element.addEventListener("click",function(e){e.preventDefault();var t=e.target;if(t.nodeName.toLowerCase()!="a")return;s.hide();if(t.hasClass("hide"))return;var r="filterBy"+(n=="author"?"Author":"Category");i[r](t.textContent)},!1)},e.Forum.Modules.add("hauptseite",e.Forum.Statistics),e.Forum.Statistics.show=function(n){var r=e.Forum;r.ContextMenu.hide();var i=new r.Layer({id:n+"Statistics"});i.show();var s=window.pageYOffset+10,o=window.innerHeight-10-10-10-2-16;i.element.style.top=s+"px",i.element.style.maxHeight=o+"px"},e.Forum.Statistics.hide=function(){var n=e.Forum;(new n.Layer({id:"categoryStatistics"})).hide(),(new n.Layer({id:"authorStatistics"})).hide()},e.Forum.Sorting={},e.Forum.Sorting.init=function(){var n=document.getElementById("themenfilter");if(!n)return;var r=document.createElement("div");r.id="sortierung",r.innerHTML="<p><strong>Sortierung der Threads:</strong></p><ul><li><label title='Threads nach Er\u00f6ffnungsposting chronologisch absteigend sortieren (neue Threads oben, alte Threads unten)'><input type='radio' name='sortthreads' value='descending' />&nbsp;Absteigend (Standard)</label></li><li><label title='Threads nach Er\u00f6ffnungsposting chronologisch absteigend sortieren (alte Threads oben, neue Threads unten)'><input type='radio' name='sortthreads' value='ascending' />&nbsp;Aufsteigend</label></li><li><label title='Threads nach dem j\u00fcngsten Posting sortieren (Threads mit neuen Postings oben, nicht mehr aktive unten)'><input type='radio' name='sortthreads' value='newestfirst' />&nbsp;Nach j\u00fcngstem Posting</label></li></ul>",r.addEventListener("click",e.Forum.Sorting.change,!1),n.parentNode.insertBefore(r,n)},e.Forum.Modules.add("hauptseite",e.Forum.Sorting),e.Forum.Sorting.change=function(n){var r=e.Forum.Config,i=n.target,s=i.nodeName.toLowerCase(),o;if(s!="input")return;n.stopPropagation(),r.setValue("SortThreads",i.value),r.confirmReload()}})()